<!DOCTYPE html>
<html>
<head>
    <title>Volta</title>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBtZONodr8731LhzdyStOKutzP83XjEDvk"></script>
    </script>
</head>
<body>
    <div id="map" style="height: 500px;""></div>

    <script>
        
        var m = document.getElementById('map');
        var map;

        // put map on page
        function initMap() {
            var mapOptions = {
                zoom: 13,
                center: {lat: 37.765, lng: -122.419}
            };
            map = new google.maps.Map(m, mapOptions);
        }

        var headers = {
          'Accept':'application/json'

        };

        // Volta API
        $.ajax({
          url: 'https://api.voltaapi.com/v1/stations',
          method: 'get',

          headers: headers,
          success: classifyMarker,
        })


        // Active stations vs "under construction" or "needs service" stations
        var active = [];
        var troubled = [];

        function classifyMarker(data){

            // loop over obtained from API stations
            for (var i = 0; i < data.length; i++) {
                var coords = data[i].location.coordinates;
                var latLng = new google.maps.LatLng(coords[1],coords[0]);
                var title = data[i].name;
                
                // set icon depending on status
                if (data[i].status == 'active'){
                    var icon = 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m1.png';
                } else if (data[i].status == 'under construction'){
                    var icon = 'http://maps.google.com/mapfiles/ms/micons/yellow.png';
                } else {
                    var icon = 'http://maps.google.com/mapfiles/ms/micons/red.png';
                };
                
                // create marker
                var marker = new google.maps.Marker({
                        position: latLng,
                        icon: icon,
                        title: title
                    });
                
                // classify marker and put into appropriate array
                if (data[i].status == 'active'){
                    active.push(marker);
                } else {
                    troubled.push(marker);
                } 
            }
        console.log(active.length);
        console.log(troubled.length);
        }

        function putCluster(markers){
            pass;
        }

        function putMarker(markers){
            pass;
        }


        function putData(markers){
            classifyMarker(data);
            putCluster(active);
            putMarker(troubled);


        }

        initMap();
        // classifyMarker();




    </script>
</body>
</html>